<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aiyel</title>

  <!-- Puter.js -->
  <script src="https://js.puter.com/v2/"></script>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial; }
  </style>
</head>

<body class="min-h-screen bg-slate-950 text-slate-100">
  <!-- Beautiful background -->
  <div class="pointer-events-none fixed inset-0">
    <div class="absolute -top-40 -right-40 h-[520px] w-[520px] rounded-full bg-emerald-500/20 blur-3xl"></div>
    <div class="absolute -bottom-40 -left-40 h-[520px] w-[520px] rounded-full bg-indigo-500/20 blur-3xl"></div>
    <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,rgba(16,185,129,0.08),transparent_55%),radial-gradient(ellipse_at_bottom,rgba(99,102,241,0.08),transparent_55%)]"></div>
  </div>

  <main class="relative mx-auto max-w-6xl px-4 py-10">
    <!-- Header -->
    <header class="mb-8">
      <div class="flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between">
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">
            AI Image Generator
          </h1>
          <p class="mt-2 text-slate-300 leading-relaxed">
            Write a description (prompt), choose a model, then click “Generate”. Your image will appear in the gallery.
          </p>
        </div>

        <div class="flex gap-2">
          <button id="demoBtn"
            class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold hover:bg-white/10 active:scale-[.99] transition">
            Auto Prompt
          </button>
          <button id="clearBtn"
            class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm font-semibold hover:bg-white/10 active:scale-[.99] transition">
            Clear Gallery
          </button>
        </div>
      </div>

      <div class="mt-5 rounded-2xl border border-amber-400/20 bg-amber-300/5 p-4 text-sm text-amber-100/90">
        Note: Aiyel relies on Puter for image generation and operates in User-Pays / Confirmation mode.
      </div>
    </header>

    <!-- Layout -->
    <section class="grid grid-cols-1 gap-6 lg:grid-cols-3">
      <!-- Controls -->
      <div class="lg:col-span-1">
        <div class="rounded-3xl border border-white/10 bg-white/[0.04] p-5 shadow-[0_12px_50px_rgba(0,0,0,0.35)] backdrop-blur">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-bold">Settings</h2>
            <span id="badge"
              class="hidden rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs text-slate-200">
            </span>
          </div>

          <label class="mt-4 block text-sm font-semibold text-slate-200">Prompt</label>
          <textarea id="prompt"
            class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950/40 p-3 text-sm leading-relaxed text-slate-100 placeholder:text-slate-500 focus:border-emerald-400/40 focus:ring-2 focus:ring-emerald-400/20 outline-none min-h-[140px]"
            placeholder='Example: A man wearing modern African streetwear in a futuristic city, cinematic lighting...'></textarea>

          <div class="mt-4 grid grid-cols-1 gap-3">
            <div>
              <label class="block text-sm font-semibold text-slate-200">Model</label>
              <select id="model"
                class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950/40 p-3 text-sm text-slate-100 focus:border-emerald-400/40 focus:ring-2 focus:ring-emerald-400/20 outline-none">
                <option value="gpt-image-1">gpt-image-1</option>
                <option value="dall-e-3">dall-e-3</option>
                <option value="dall-e-2">dall-e-2</option>
                <option value="gemini-2.5-flash-image-preview">gemini-2.5-flash-image-preview</option>
                <option value="stabilityai/stable-diffusion-3-medium">stable-diffusion-3-medium</option>
              </select>
            </div>

            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-sm font-semibold text-slate-200">Quality</label>
                <select id="quality"
                  class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950/40 p-3 text-sm text-slate-100 focus:border-emerald-400/40 focus:ring-2 focus:ring-emerald-400/20 outline-none">
                  <option value="">Default</option>
                  <option value="standard">standard</option>
                  <option value="hd">hd</option>
                </select>
              </div>

              <div>
                <label class="block text-sm font-semibold text-slate-200">Image Count</label>
                <select id="count"
                  class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950/40 p-3 text-sm text-slate-100 focus:border-emerald-400/40 focus:ring-2 focus:ring-emerald-400/20 outline-none">
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="4">4</option>
                </select>
              </div>
            </div>

            <div class="mt-2 flex flex-col gap-2">
              <button id="genBtn"
                class="inline-flex items-center justify-center gap-2 rounded-2xl bg-emerald-400 px-4 py-3 text-sm font-extrabold text-slate-900 hover:bg-emerald-300 active:scale-[.99] transition disabled:opacity-60 disabled:cursor-not-allowed">
                <span id="genText">Generate</span>
                <span id="spinner" class="hidden h-4 w-4 animate-spin rounded-full border-2 border-slate-900 border-t-transparent"></span>
              </button>

              <div class="grid grid-cols-2 gap-2">
                <button id="copyBtn"
                  class="rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-semibold hover:bg-white/10 active:scale-[.99] transition">
                  Copy Prompt
                </button>
                <button id="regenBtn"
                  class="rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-semibold hover:bg-white/10 active:scale-[.99] transition">
                  Regenerate
                </button>
              </div>
            </div>

            <!-- Status (with icon) -->
            <div id="status" class="mt-1 flex items-center gap-2 text-sm">
              <img
                id="statusIcon"
                src="success.png"
                alt="success"
                class="hidden h-6 w-6 opacity-90 drop-shadow"
              />
              <span id="statusText" class="text-slate-300"></span>
            </div>

          </div>
        </div>
      </div>

      <!-- Gallery -->
      <div class="lg:col-span-2">
        <div class="rounded-3xl border border-white/10 bg-white/[0.04] p-5 shadow-[0_12px_50px_rgba(0,0,0,0.35)] backdrop-blur">
          <div class="flex items-center justify-between">
            <h2 class="text-lg font-bold">Gallery</h2>
            <div class="text-sm text-slate-300">
              <span id="counter">0</span> images
            </div>
          </div>

          <div id="grid" class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"></div>

          <div id="empty" class="mt-6 rounded-2xl border border-white/10 bg-slate-950/30 p-6 text-center text-slate-300">
            No images yet. Type a prompt and click “Generate”.
          </div>
        </div>
      </div>
    </section>
  </main>

<script>
  const promptEl = document.getElementById("prompt");
  const modelEl  = document.getElementById("model");
  const qualityEl= document.getElementById("quality");
  const countEl  = document.getElementById("count");

  const genBtn   = document.getElementById("genBtn");
  const regenBtn = document.getElementById("regenBtn");
  const clearBtn = document.getElementById("clearBtn");
  const demoBtn  = document.getElementById("demoBtn");
  const copyBtn  = document.getElementById("copyBtn");

  const gridEl   = document.getElementById("grid");
  const emptyEl  = document.getElementById("empty");
  const counterEl= document.getElementById("counter");
  const badgeEl  = document.getElementById("badge");

  const genText  = document.getElementById("genText");
  const spinner  = document.getElementById("spinner");

  const statusIcon = document.getElementById("statusIcon");
  const statusText = document.getElementById("statusText");

  function setStatus(msg, kind = "info") {
    statusText.textContent = msg || "";

    statusText.className =
      kind === "ok"  ? "text-emerald-200" :
      kind === "err" ? "text-rose-200" :
      "text-slate-300";

    if (kind === "ok") statusIcon.classList.remove("hidden");
    else statusIcon.classList.add("hidden");
  }

  function setLoading(isLoading) {
    genBtn.disabled = isLoading;
    regenBtn.disabled = isLoading;
    genText.textContent = isLoading ? "Generating..." : "Generate";
    spinner.classList.toggle("hidden", !isLoading);
  }

  function updateEmptyState() {
    const count = gridEl.children.length;
    counterEl.textContent = count.toString();
    emptyEl.classList.toggle("hidden", count !== 0);
  }

  function safeFilename() {
    const t = new Date();
    const pad = (n)=> String(n).padStart(2,"0");
    return `generated_${t.getFullYear()}-${pad(t.getMonth()+1)}-${pad(t.getDate())}_${pad(t.getHours())}${pad(t.getMinutes())}${pad(t.getSeconds())}.png`;
  }

  function downloadImageSrc(src) {
    const a = document.createElement("a");
    a.href = src;
    a.download = safeFilename();
    a.target = "_blank";
    a.rel = "noopener";
    document.body.appendChild(a);
    a.click();
    a.remove();
  }

  function escapeHtml(s) {
    return (s || "").replace(/[&<>"']/g, (c) => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[c]));
  }

  function addImageCard(imgEl, promptText, model, quality) {
    const card = document.createElement("div");
    card.className = "group overflow-hidden rounded-2xl border border-white/10 bg-slate-950/30";

    const top = document.createElement("div");
    top.className = "relative";

    imgEl.className = "w-full aspect-square object-cover";
    imgEl.loading = "lazy";
    top.appendChild(imgEl);

    const overlay = document.createElement("div");
    overlay.className = "absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/70 via-black/10 to-transparent opacity-100";
    overlay.innerHTML = `
      <div class="flex items-center justify-between gap-2">
        <div class="text-xs text-slate-200/90">
          <div class="font-bold">${model}</div>
          <div class="text-slate-300">${quality ? "Quality: " + quality : "Quality: default"}</div>
        </div>
        <div class="flex gap-2">
          <button class="dlBtn rounded-xl bg-white/10 px-3 py-1.5 text-xs font-bold text-slate-100 hover:bg-white/20 transition">
            Download
          </button>
        </div>
      </div>
    `;
    top.appendChild(overlay);

    const body = document.createElement("div");
    body.className = "p-3";
    body.innerHTML = `
      <p class="text-sm text-slate-200 line-clamp-3 leading-relaxed">${escapeHtml(promptText)}</p>
      <div class="mt-2 flex items-center justify-between text-xs text-slate-400">
        <span>${new Date().toLocaleString()}</span>
        <button class="copyPrompt rounded-lg border border-white/10 bg-white/5 px-2 py-1 hover:bg-white/10 transition">Copy</button>
      </div>
    `;

    card.appendChild(top);
    card.appendChild(body);

    card.querySelector(".dlBtn").addEventListener("click", () => {
      if (imgEl.src) downloadImageSrc(imgEl.src);
      else alert("Image URL is not ready yet.");
    });

    card.querySelector(".copyPrompt").addEventListener("click", async () => {
      await navigator.clipboard.writeText(promptText);
      setStatus("Prompt copied.", "ok");
    });

    gridEl.prepend(card);
    updateEmptyState();
  }

  async function generateMany() {
    const prompt = (promptEl.value || "").trim();
    if (!prompt) return setStatus("Please enter a prompt first.", "err");

    setLoading(true);
    setStatus("Generating images...", "info");

    const model = modelEl.value;
    const quality = qualityEl.value;
    const count = Number(countEl.value || 1);

    badgeEl.textContent = `${model} • ${quality || "default"} • x${count}`;
    badgeEl.classList.remove("hidden");

    try {
      const options = { model };
      if (quality) options.quality = quality;

      for (let i = 0; i < count; i++) {
        const imgEl = await puter.ai.txt2img(prompt, options);
        addImageCard(imgEl, prompt, model, quality);
      }

      setStatus("Done!", "ok");
    } catch (err) {
      console.error(err);
      setStatus("Generation failed. Some models may not work.");
      alert("Generation failed. Make sure Puter is allowed in your browser.");
    } finally {
      setLoading(false);
    }
  }

  genBtn.addEventListener("click", generateMany);
  regenBtn.addEventListener("click", generateMany);

  clearBtn.addEventListener("click", () => {
    gridEl.innerHTML = "";
    badgeEl.classList.add("hidden");
    setStatus("");
    updateEmptyState();
  });

  demoBtn.addEventListener("click", () => {
    promptEl.value = "A premium streetwear outfit with modern African patterns, studio fashion shoot, cinematic lighting, ultra detailed, 35mm film look.";
    setStatus("Auto prompt loaded. Click Generate.", "ok");
  });

  copyBtn.addEventListener("click", async () => {
    const prompt = (promptEl.value || "").trim();
    if (!prompt) return setStatus("No prompt to copy.", "err");
    await navigator.clipboard.writeText(prompt);
    setStatus("Prompt copied.", "ok");
  });

  updateEmptyState();
</script>

</body>
</html>

